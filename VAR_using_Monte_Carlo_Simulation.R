##calculating VAR using MONTE-CARLO simulation
set.seed(22-11-2019)

gbm<-function(s,sigma,T,n){        
  
    return (s*exp((-(sigma^2/2)*T)+(sigma*(T^0.5)*rnorm(n))))
    
}


nt=1001;s=100;sigma=0.4;T=1;n=11;k=100
dt=1/365;t=c(seq.int(T,by=-dt,length.out = n))
X=matrix(rep(0,length(t)*nt),ncol=nt)
X[,1]=t
for(i in 2:nt){
  
  X[,i]=gbm(100,0.4,1,11)}

initial_stock_price<-rep(s,length.out=1000)

Y<-X[,-1]

set.seed(22-11-2019)
blackschole<-function(s,k,r,T,sigma){
  d1<-log(s/k)+(r+(sigma^2/2)*T)/(sigma*sqrt(T))
  d2<-d1-(sigma*sqrt(T))
  (s*pnorm(d1))-(k*exp(-r*T)*pnorm(d2))
  
}
z<-blackschole(Y[11,],100,0.05,0.9726,0.4)
c10<-z
c0<-blackschole(initial_stock_price,100,0.05,1,0.4) 
m<-c10-c0

m1<-as.vector(m) 
sort(m1,decreasing=FALSE)
quantile(m1,probs=c(0.9,0.95,0.99,0.05),type=4)
hist(m,main="Histogram of call premiums for 1000 runs",xlab="difference of call price",col="darkmagenta")

OUTPUT-

The difference between 10th day and initial call price-
[1] -22.39715048 -22.39676517 -22.39462836 -22.39414512 -22.39253637 -22.38945047
   [7] -22.38817142 -22.38510064 -22.37058621 -22.35398090 -22.34399812 -22.32860183
  [13] -22.32634781 -22.32156379 -22.31800740 -22.31140694 -22.29658502 -22.29492383
  [19] -22.29249308 -22.26396050 -22.26377210 -22.26355789 -22.25817372 -22.24868848
  [25] -22.20900338 -22.20816674 -22.20790672 -22.16646592 -22.15706856 -22.15213708
  [31] -22.12745284 -22.08407818 -22.04218640 -22.01959214 -22.00854972 -21.96099957
  [37] -21.95184236 -21.90080769 -21.85890291 -21.81678447 -21.79238729 -21.78796939
  [43] -21.78458433 -21.77705558 -21.72955485 -21.69415108 -21.68529062 -21.64796413
  [49] -21.62469944 -21.61581748 -21.59899376 -21.52817138 -21.52341440 -21.43882978
  [55] -21.42738372 -21.40739907 -21.38895428 -21.38698498 -21.38425611 -21.37095268
  [61] -21.36086601 -21.35864569 -21.35175831 -21.34485586 -21.31169060 -21.30971281
  [67] -21.30706106 -21.25958381 -21.25572711 -21.24157005 -21.19963140 -21.19474134
  [73] -21.17930981 -21.17260508 -21.15362872 -21.07407644 -21.04956114 -21.03300822
  [79] -21.02891400 -20.99735982 -20.87119704 -20.80750568 -20.78883535 -20.77690409
  [85] -20.73250400 -20.67188332 -20.66929308 -20.65865714 -20.65640015 -20.64065798
  [91] -20.62957184 -20.62767699 -20.61261470 -20.59299936 -20.56421516 -20.51819579
  [97] -20.51576119 -20.47664465 -20.47626407 -20.40647747 -20.37421548 -20.36586965
 [103] -20.34517435 -20.30072340 -20.28715332 -20.23109880 -20.22330244 -20.22024725
 [109] -20.19479712 -20.14419169 -20.11924667 -20.06511268 -20.05563080 -20.04446407
 [115] -20.00643958 -19.98051725 -19.94655651 -19.92248011 -19.89801004 -19.88257958
 [121] -19.84648431 -19.78561735 -19.77857126 -19.76931567 -19.74790735 -19.72463108
 [127] -19.71157060 -19.69777449 -19.69721703 -19.42676586 -19.39352038 -19.34676923
 [133] -19.33178117 -19.31637864 -19.30548515 -19.25272925 -19.16533617 -19.02897219
 [139] -18.93611648 -18.83682093 -18.83038484 -18.80199001 -18.78558480 -18.77280099
 [145] -18.70579708 -18.69706858 -18.67754120 -18.60265048 -18.56843679 -18.55256984
 [151] -18.54650356 -18.47421286 -18.46984674 -18.46904595 -18.46567125 -18.45641974
 [157] -18.35190703 -18.34761685 -18.34464638 -18.32534716 -18.30999178 -18.20818628
 [163] -18.19506523 -18.19155469 -18.16978764 -18.14590219 -18.13958314 -18.13341227
 [169] -18.08770626 -18.02793050 -17.95428838 -17.93108203 -17.91195524 -17.89653176
 [175] -17.87397010 -17.84107331 -17.82869599 -17.80981790 -17.75328639 -17.74832915
 [181] -17.73497252 -17.68020963 -17.64983596 -17.62313854 -17.58609366 -17.56466812
 [187] -17.46535863 -17.45079729 -17.41370998 -17.30561143 -17.29748230 -17.29737475
 [193] -17.28068819 -17.24656377 -17.20858316 -17.17585073 -17.16070137 -17.07431308
 [199] -17.04468391 -16.99846630 -16.96731123 -16.96246342 -16.95151929 -16.95040766
 [205] -16.94351173 -16.90832989 -16.87896035 -16.84883686 -16.80663720 -16.79831876
 [211] -16.77835103 -16.77438821 -16.77421635 -16.75809928 -16.72546701 -16.60706967
 [217] -16.59141489 -16.56201201 -16.55055079 -16.54785223 -16.38951963 -16.38896497
 [223] -16.36317900 -16.32820509 -16.29775274 -16.25690485 -16.24722774 -16.21290367
 [229] -16.12191667 -16.10805402 -16.09649439 -16.02507017 -16.01225948 -15.95393457
 [235] -15.92874307 -15.81393042 -15.79644074 -15.77996010 -15.71709812 -15.71108917
 [241] -15.63163602 -15.62167494 -15.60326145 -15.59544480 -15.59293145 -15.58898972
 [247] -15.58555111 -15.50306171 -15.48199016 -15.48101242 -15.45538355 -15.44440533
 [253] -15.37509195 -15.29379189 -15.26098133 -15.24520903 -15.23932209 -15.22745578
 [259] -15.19275419 -15.14851011 -15.07592043 -15.02576863 -15.01793942 -14.96705461
 [265] -14.92618148 -14.89203014 -14.86754879 -14.85520697 -14.82285169 -14.80437090
 [271] -14.78464113 -14.74780370 -14.71501411 -14.70984509 -14.70097731 -14.69688060
 [277] -14.64255276 -14.62254887 -14.60856442 -14.59982189 -14.58818233 -14.57560026
 [283] -14.56055492 -14.54462946 -14.52376798 -14.46870070 -14.45858017 -14.43048532
 [289] -14.38556450 -14.38328425 -14.34263961 -14.34160809 -14.33433758 -14.27996080
 [295] -14.25688407 -14.21640062 -14.11285932 -14.10783396 -14.08556889 -14.07842826
 [301] -14.06544751 -14.05875935 -14.05072163 -14.04850932 -14.02973795 -13.91795856
 [307] -13.90836622 -13.86460419 -13.73181020 -13.71037237 -13.66687699 -13.61631585
 [313] -13.59728956 -13.50738297 -13.46302715 -13.43359403 -13.41880519 -13.37209492
 [319] -13.34977337 -13.34685551 -13.32691937 -13.32477618 -13.32298730 -13.25381981
 [325] -13.25366560 -13.22453819 -13.21514209 -13.18371381 -13.18351678 -13.16066741
 [331] -13.15885817 -13.09269050 -13.07819688 -13.00822095 -12.94062095 -12.90983525
 [337] -12.90172749 -12.85549128 -12.81420170 -12.70523580 -12.70139427 -12.64220907
 [343] -12.56704973 -12.52904138 -12.45329230 -12.41246795 -12.35343821 -12.32860282
 [349] -12.29501997 -12.26445361 -12.21903285 -12.15474479 -12.12608349 -12.10952274
 [355] -12.10552224 -12.03608225 -12.03116184 -11.99962844 -11.98805275 -11.96752091
 [361] -11.94056018 -11.89565850 -11.86462699 -11.84722882 -11.81263285 -11.74444886
 [367] -11.60681752 -11.60178069 -11.57010639 -11.56181567 -11.54006225 -11.51836646
 [373] -11.51339269 -11.49591341 -11.41435131 -11.41349738 -11.37557615 -11.25747891
 [379] -11.23395074 -11.16101850 -11.05481567 -11.02802892 -10.99615805 -10.96662082
 [385] -10.84780879 -10.84687971 -10.79052843 -10.76587648 -10.74534014 -10.71747247
 [391] -10.63686683 -10.61701259 -10.59752682 -10.56694523 -10.52746120 -10.48310923
 [397] -10.43229423 -10.43180248 -10.43104862 -10.33118579 -10.23838010 -10.20721969
 [403] -10.02535127  -9.94520723  -9.90954351  -9.89778752  -9.82390342  -9.75123607
 [409]  -9.74820601  -9.71578322  -9.69380302  -9.65635249  -9.64432029  -9.62986435
 [415]  -9.62504877  -9.59727789  -9.57209919  -9.52387670  -9.44848393  -9.43802277
 [421]  -9.41322012  -9.35514392  -9.33772301  -9.32709551  -9.30881785  -9.29691734
 [427]  -9.14029833  -9.13690846  -9.06449960  -9.04435654  -8.99828245  -8.99585091
 [433]  -8.82317241  -8.80389730  -8.78652396  -8.61670962  -8.57207150  -8.55457912
 [439]  -8.52803737  -8.50657743  -8.49954508  -8.47906555  -8.43387809  -8.33661623
 [445]  -8.33512915  -8.16751384  -8.09329166  -8.05087455  -8.03128148  -8.00901864
 [451]  -7.97395710  -7.95999599  -7.89750720  -7.85468114  -7.84288712  -7.82798436
 [457]  -7.79935433  -7.78170421  -7.68917850  -7.68668553  -7.65659372  -7.59734298
 [463]  -7.57907423  -7.54834635  -7.51220452  -7.50019938  -7.49979693  -7.49812517
 [469]  -7.45153645  -7.38400150  -7.35497455  -7.31553011  -7.28800684  -7.28501003
 [475]  -7.24184111  -7.23758444  -7.17333738  -7.12119049  -7.09474414  -7.08154065
 [481]  -7.05582326  -7.04707745  -7.04277367  -6.93585482  -6.84353343  -6.78902240
 [487]  -6.69146910  -6.59269780  -6.53945947  -6.53121026  -6.45879264  -6.45806410
 [493]  -6.44733776  -6.36192178  -6.31034429  -6.26756042  -6.26573185  -6.17455794
 [499]  -6.16587606  -5.93043055  -5.93002129  -5.81651051  -5.81517171  -5.68962821
 [505]  -5.64463733  -5.53273877  -5.45499425  -5.42514771  -5.29370788  -5.25259139
 [511]  -5.18081104  -4.80308359  -4.77350339  -4.72639559  -4.71363698  -4.70217614
 [517]  -4.68373460  -4.65904194  -4.65041797  -4.63262923  -4.50358075  -4.47815423
 [523]  -4.15116592  -4.13740187  -4.11121490  -4.03528162  -4.03268434  -4.02553017
 [529]  -3.99497456  -3.88718024  -3.87035417  -3.72129791  -3.65102501  -3.60881957
 [535]  -3.53890903  -3.47227695  -3.46500625  -3.32173797  -3.29879079  -3.28258707
 [541]  -3.19866702  -3.11801463  -3.09905024  -3.04012522  -2.98660839  -2.97027626
 [547]  -2.92009168  -2.82196867  -2.78748975  -2.65090694  -2.54553995  -2.52110342
 [553]  -2.39188628  -2.35676776  -2.33833883  -2.26192685  -2.24505956  -2.12472540
 [559]  -2.10963387  -2.10044793  -2.08545661  -2.00271175  -1.97066504  -1.88125990
 [565]  -1.86680206  -1.84345128  -1.83299018  -1.79898253  -1.71265410  -1.59814081
 [571]  -1.44238579  -1.33835676  -1.28863943  -1.25107420  -1.23315203  -1.17262343
 [577]  -1.08429213  -1.01265909  -1.00392231  -0.98786320  -0.97210393  -0.96629255
 [583]  -0.94877224  -0.90634605  -0.60070767  -0.52045549  -0.43991003  -0.36682238
 [589]  -0.36517924  -0.15586454  -0.05851897   0.12495536   0.23678093   0.24319452
 [595]   0.46047910   0.61101286   0.65310422   0.68847010   0.82412390   0.86071610
 [601]   0.97372463   0.98219668   0.99945836   1.00472472   1.05054825   1.17273599
 [607]   1.20613852   1.21468581   1.32559789   1.40441265   1.47017032   1.48174476
 [613]   1.50661360   1.57598610   1.58265426   1.66785183   1.73541547   1.76807924
 [619]   1.77275752   1.77964822   1.79619736   1.82737226   1.84307104   1.92788969
 [625]   1.97702594   1.99684954   2.02341542   2.02964242   2.24202160   2.25932258
 [631]   2.41592978   2.48078758   2.55749527   2.68919716   2.68986445   2.74370205
 [637]   2.84245185   2.93271624   2.98122343   3.14090377   3.28123954   3.52876730
 [643]   3.55278090   3.56645664   3.59407396   3.68684048   3.73193554   3.77369581
 [649]   3.84849175   3.92469057   4.06099828   4.10026025   4.11984562   4.13840609
 [655]   4.29192980   4.30409738   4.52285748   4.53926522   4.70385993   4.77042717
 [661]   4.85791827   4.88343399   4.93519284   4.95602736   4.97937368   5.00625270
 [667]   5.01280344   5.05411168   5.07439198   5.15478387   5.28656566   5.28671242
 [673]   5.31568839   5.40469635   5.85589267   5.87772001   5.88255282   5.89826153
 [679]   5.93431072   6.01580234   6.03843658   6.13656240   6.18580090   6.34197454
 [685]   6.36813192   6.62623728   6.71279144   6.75204147   6.78307116   6.80709599
 [691]   6.99938970   7.36664075   7.38706543   7.44768420   7.58594314   8.13933609
 [697]   8.23388355   8.24989591   8.32794903   8.48395870   8.59360718   8.69010075
 [703]   8.82527851   8.83538827   8.95130377   9.05340620   9.27079625   9.52245388
 [709]   9.78364700   9.81421922   9.96186431   9.96957244  10.07036904  10.11310425
 [715]  10.14929226  10.16256735  10.26309381  10.29674280  10.40108771  10.56136775
 [721]  10.61948910  10.88011160  10.91620443  11.18082594  11.30245714  11.46107589
 [727]  11.72496238  11.87161954  12.24732453  12.39959725  12.59578713  12.65694566
 [733]  12.73516848  12.74997407  12.80803623  13.01543409  13.10912340  13.14852566
 [739]  13.24134036  13.30387323  13.34675772  13.38016407  13.38528400  13.45170325
 [745]  13.91652694  13.94570004  13.98659429  14.20046495  14.25602696  14.26371359
 [751]  14.45417815  14.46431014  15.11864384  15.14946161  15.46530206  15.60072811
 [757]  15.63765534  15.71339018  15.92866291  15.95695692  16.01295760  16.15074487
 [763]  16.32398194  16.53332665  16.72913712  16.84216795  16.92518047  16.93011467
 [769]  16.93790927  16.96996676  17.06989863  17.19696625  17.27258987  17.37781840
 [775]  17.45806656  17.46644734  17.49221384  17.69253757  17.70719893  18.10323717
 [781]  18.14149485  18.20237795  18.26697165  18.35704643  18.64429087  18.72567159
 [787]  18.76483554  18.90390184  19.15422097  19.17552052  19.21669492  19.52615244
 [793]  19.65533087  19.81646934  19.93314939  20.00108606  20.09484206  20.56322884
 [799]  20.68087009  20.85766657  21.33862744  21.40105109  21.42477727  21.54481209
 [805]  21.72499947  21.74632566  21.75771477  21.86789158  22.17809691  22.43432249
 [811]  22.55406680  22.78225636  22.97976655  23.12999293  23.26417465  23.43485383
 [817]  23.57614477  23.58797411  23.82864426  23.95670503  24.52574635  24.53606647
 [823]  24.54496294  24.60800197  24.84958882  25.19553714  25.58168237  25.63853808
 [829]  25.71892282  25.87397533  25.96700156  26.03440564  26.19022681  26.31062534
 [835]  26.44086225  27.05078112  27.21408001  27.21649818  27.31276984  27.58282195
 [841]  27.62850413  27.67164449  27.68465813  27.93624431  28.02360904  28.05147596
 [847]  28.17081819  28.56367441  28.67860898  28.83380838  28.89949139  28.91312835
 [853]  28.92471451  29.10849839  29.42952962  29.50410955  29.66399476  29.78403500
 [859]  29.86267623  30.02628378  30.90439598  31.31041980  31.45079612  31.64609946
 [865]  31.71555458  31.82835268  31.87505752  31.97783190  32.67816648  33.01994423
 [871]  34.12692638  34.35500732  34.35749831  34.56044988  35.58233851  35.79779899
 [877]  36.45048417  36.78863358  37.32510304  37.49422850  37.76171777  38.19228749
 [883]  38.22188757  38.53118044  39.04545660  39.10370268  39.35815095  39.38251812
 [889]  40.18841767  41.11318946  41.79193962  42.22503638  42.25738223  42.45294090
 [895]  42.56494654  43.39878196  43.93757203  44.18302584  44.83289675  44.99270089
 [901]  45.05551336  45.18596624  45.25358968  45.37444949  45.45023365  45.49369376
 [907]  45.68029997  45.74853527  45.80125633  45.96078560  46.03023454  46.43371396
 [913]  46.71327943  47.63047745  48.83031914  48.85579278  48.98147063  48.99332318
 [919]  49.13829461  49.30332812  50.16530057  50.95113472  51.08692426  51.56798769
 [925]  53.57673351  53.90796275  54.02848764  54.54142320  54.85589173  55.41483963
 [931]  56.30622350  56.32473327  56.55739080  57.22368618  57.84920819  57.89958397
 [937]  58.09464449  59.88468044  60.02094710  60.19263298  60.28131172  60.73985305
 [943]  61.40707944  62.00445562  62.11799259  62.55911911  62.69320869  63.03671821
 [949]  63.24173381  63.99544308  64.32610705  64.53734953  65.26850206  67.25140094
 [955]  68.27818027  69.26817665  70.80471690  71.65049127  72.05147045  72.73350541
 [961]  73.18903265  74.16982836  74.21625160  76.79964091  76.87228699  76.99632810
 [967]  77.38251017  77.45450856  78.06843976  78.22403295  78.51913030  81.84037643
 [973]  82.33865199  82.95748376  86.08502462  87.49384129  87.70608870  88.51454830
 [979]  88.55903598  94.38802007  94.50398382  96.12955090  99.34493494  99.45200016
 [985] 100.95094376 105.96726697 110.15317885 113.97979169 115.07657071 118.23754318
 [991] 120.29085128 126.69737834 128.44537961 130.21453283 132.20247785 137.91959645
 [997] 166.30555169 172.07654894 222.72999757 281.06805990

90%,95%,99% and 5% VAR-
      90%       95%       99%        5% 
 44.99270  63.99544 118.23754 -21.61582 
> 
                 
